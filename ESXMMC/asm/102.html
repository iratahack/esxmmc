<!DOCTYPE html>
<html>
<head>
<title>ESXMMC: Routine at 0066</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">ESXMMC</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="91.html">005b</a>
</td>
<td class="up">Up: <a href="../maps/all.html#102">Map</a></td>
<td class="next">
Next: <a href="134.html">0086</a>
</td>
</tr>
</table>
<div class="description">0066: DivMMC NMI entry point</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="asm-label">L0066</td>
<td class="address-2"><span id="102"></span>0066</td>
<td class="instruction">ret</td>
<td class="comment-1" rowspan="1">NMI does nothing in DivMMC</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="103"></span>
<div class="comments">
<div class="paragraph">
NMI entry point from 48K ROM
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="103"></span>0067</td>
<td class="instruction">nop</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="104"></span>0068</td>
<td class="instruction">ld ($3df4),hl</td>
<td class="comment-1" rowspan="1">Save hl.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="107"></span>006b</td>
<td class="instruction">ld hl,($3df9)</td>
<td class="comment-1" rowspan="1">Get the currently selected DivMMC RAM bank into l.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="110"></span>006e</td>
<td class="instruction">ld h,a</td>
<td class="comment-1" rowspan="1">Save a in h</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="111"></span>006f</td>
<td class="instruction">ld a,$00</td>
<td class="comment-1" rowspan="1">Map in RAM bank 0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="113"></span>0071</td>
<td class="instruction">out ($e3),a</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="115"></span>0073</td>
<td class="instruction">ld ($2e7b),hl</td>
<td class="comment-1" rowspan="1">Save currently selected RAM bank and the original value in a.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="118"></span>0076</td>
<td class="instruction">ld a,l</td>
<td class="comment-1" rowspan="1">Switch back to the RAM bank we started with.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="119"></span>0077</td>
<td class="instruction">out ($e3),a</td>
<td class="comment-1" rowspan="1">Map in the bank.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="121"></span>0079</td>
<td class="instruction">ld hl,($3df4)</td>
<td class="comment-1" rowspan="1">Restore hl.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="124"></span>007c</td>
<td class="instruction">ld a,$00</td>
<td class="comment-1" rowspan="1">Map in RAM bank 0.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="126"></span>007e</td>
<td class="instruction">out ($e3),a</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="128"></span>0080</td>
<td class="instruction">ld a,($2e7c)</td>
<td class="comment-1" rowspan="1">???</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="131"></span>0083</td>
<td class="instruction">jp $201e</td>
<td class="comment-1" rowspan="1">Spring-board into the NMI handler in RAM.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="91.html">005b</a>
</td>
<td class="up">Up: <a href="../maps/all.html#102">Map</a></td>
<td class="next">
Next: <a href="134.html">0086</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright"></div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
</footer>
</body>
</html>