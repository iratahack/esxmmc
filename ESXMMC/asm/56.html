<!DOCTYPE html>
<html>
<head>
<title>ESXMMC: Routine at 0038</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">ESXMMC</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="55.html">0037</a>
</td>
<td class="up">Up: <a href="../maps/all.html#56">Map</a></td>
<td class="next">
Next: <a href="64.html">0040</a>
</td>
</tr>
</table>
<div class="description">0038: DivMMC RST $38 entry point</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
</div>
</td>
</tr>
<tr>
<td class="asm-label">L0038</td>
<td class="address-2"><span id="56"></span>0038</td>
<td class="instruction">defb $18</td>
<td class="comment-1" rowspan="1">This op-code (jr) when combined with the byte from the next address will form the instruction jr $001f.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="57"></span>
<div class="comments">
<div class="paragraph">
Entry point for RST $38 when called from the 48K ROM
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="57"></span>0039</td>
<td class="instruction">push hl</td>
<td class="comment-1" rowspan="1">Save hl, same instruction as the 48K ROM at this address. It will be discarded from the stack later. When this op-code ($e5) is combined with the op-code at address $38 ($18) you end up with a jr $001f instruction. This will be executed when an RST $38 is executed from the DivMMC ROM. The instruction at $1f jumps to $4b which performs an ei; ret. A confusing way to support both entry points for RST $38.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="58"></span>003a</td>
<td class="instruction">ld hl,$0039</td>
<td class="comment-1" rowspan="1">Address to return to in 48K ROM.</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="61"></span>003d</td>
<td class="instruction">jp <a href="8180.html">L1ff4</a></td>
<td class="comment-1" rowspan="1">Handle the transfer from DivMMC to 48K ROM.</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="55.html">0037</a>
</td>
<td class="up">Up: <a href="../maps/all.html#56">Map</a></td>
<td class="next">
Next: <a href="64.html">0040</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright"></div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.6.</div>
</footer>
</body>
</html>